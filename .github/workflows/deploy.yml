  name: Deploy to Firebase Hosting                                                                                                                                                                                                                           
                                                            
  on:                                                                                                                                                                                                                                                        
    push:                                                                                                                                                                                                                                                    
      branches: [main]

  jobs:
    deploy:
      runs-on: ubuntu-latest

      steps:
        - uses: actions/checkout@v4

        - name: Set up Node.js
          uses: actions/setup-node@v4
          with:
            node-version: 20

        - name: Install Firebase CLI
          run: npm install -g firebase-tools

        - name: Generate config files
          env:
            FIREBASE_API_KEY: ${{ secrets.FIREBASE_API_KEY }}
            FIREBASE_AUTH_DOMAIN: ${{ secrets.FIREBASE_AUTH_DOMAIN }}
            FIREBASE_PROJECT_ID: ${{ secrets.FIREBASE_PROJECT_ID }}
            FIREBASE_STORAGE_BUCKET: ${{ secrets.FIREBASE_STORAGE_BUCKET }}
            FIREBASE_MESSAGING_SENDER_ID: ${{ secrets.FIREBASE_MESSAGING_SENDER_ID }}
            FIREBASE_APP_ID: ${{ secrets.FIREBASE_APP_ID }}
            FIREBASE_MEASUREMENT_ID: ${{ secrets.FIREBASE_MEASUREMENT_ID }}
            EMAILJS_SERVICE_ID: ${{ secrets.EMAILJS_SERVICE_ID }}
            EMAILJS_PUBLIC_KEY: ${{ secrets.EMAILJS_PUBLIC_KEY }}
            EMAILJS_TEMPLATE_REGISTRATION: ${{ secrets.EMAILJS_TEMPLATE_REGISTRATION }}
            EMAILJS_TEMPLATE_VENDOR: ${{ secrets.EMAILJS_TEMPLATE_VENDOR }}
            EMAILJS_TEMPLATE_VOLUNTEER: ${{ secrets.EMAILJS_TEMPLATE_VOLUNTEER }}
            GOOGLE_SHEETS_API_KEY: ${{ secrets.GOOGLE_SHEETS_API_KEY }}
            GOOGLE_SHEETS_CLIENT_ID: ${{ secrets.GOOGLE_SHEETS_CLIENT_ID }}
            GOOGLE_SHEETS_REGISTRATIONS_ID: ${{ secrets.GOOGLE_SHEETS_REGISTRATIONS_ID }}
            GOOGLE_SHEETS_VOLUNTEERS_ID: ${{ secrets.GOOGLE_SHEETS_VOLUNTEERS_ID }}
            GOOGLE_SHEETS_VENDORS_ID: ${{ secrets.GOOGLE_SHEETS_VENDORS_ID }}
          run: chmod +x build.sh && ./build.sh

        - name: Deploy to Firebase Hosting
          run: firebase deploy --only hosting
          env:
            FIREBASE_TOKEN: ${{ secrets.FIREBASE_TOKEN }}
